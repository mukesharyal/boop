import{r as t,C as _,c as w,t as R,j as s,i as O}from"./index-CUUhV7XG.js";const E="_inputSpaceContainer_1toyf_1",N="_inputOptions_1toyf_35",T="_sendImage_1toyf_48",l={inputSpaceContainer:E,inputOptions:N,sendImage:T};function V(){const{dataChannel:u}=t.useContext(_),{chatBottom:c,setMessages:m,sentId:o,selectedMessageId:r,replying:a,messages:i,setReplying:y}=t.useContext(w),e=t.useRef(null),I=t.useRef(null),[x,d]=t.useState(!1),[n,g]=t.useState("");t.useEffect(()=>{a&&e.current.focus()},[a]);const v=()=>{console.log("Typing message sent!"),u.current.send(JSON.stringify({type:"typing"}))},C=t.useRef(R(v,800)),p=()=>{C.current(),d(!0),e.current.style.height="auto",e.current.scrollHeight>e.current.clientHeight&&(e.current.style.height=e.current.scrollHeight+"px"),g(e.current.value),O(c)&&c.current.scrollIntoView({behavior:"instant"})},S=()=>{d(!1),e.current.style.height="unset",e.current.scrollTop=e.current.scrollHeight},j=()=>{if(n==null||n.trim().length===0)return;const h={type:"text",content:n.trimEnd()},f={sentId:o.current,type:"text",origin:"sent",status:"sending",reaction:-1,content:n.trimEnd(),deleted:0};a&&(h.reply={sentId:i[r].receivedId,receivedId:i[r].sentId},f.reply={sentId:i[r].sentId,receivedId:i[r].receivedId},y(!1)),u.current.send(JSON.stringify(h)),m(M=>[...M,f]),o.current=o.current+1,e.current.value="",setTimeout(()=>{c.current.scrollIntoView({behavior:"instant"})},100),g(null)};return s.jsxs("div",{className:l.inputSpaceContainer,ref:I,children:[!x&&s.jsx("div",{className:l.inputOptions,children:s.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[s.jsx("img",{src:"./photos.svg",width:20,height:20}),s.jsx("img",{src:"./microphone.svg",width:20,height:20})]})}),s.jsx("textarea",{onChange:p,onFocus:p,onBlur:S,ref:e,placeholder:"Message",rows:1,spellCheck:!1}),s.jsx("img",{src:"./send.svg",width:24,height:24,className:l.sendImage,style:{opacity:n&&n.trim().length!=0?1:.6},onClick:j})]})}export{V as default};
