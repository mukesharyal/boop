import{r as t,C as _,c as R,t as O,j as s}from"./index-CWDg0isr.js";const T="_inputSpaceContainer_1toyf_1",w="_inputOptions_1toyf_35",E="_sendImage_1toyf_48",a={inputSpaceContainer:T,inputOptions:w,sendImage:E};function B(){const{dataChannel:l}=t.useContext(_),{chatBottom:f,setMessages:y,sentId:i,selectedMessageId:r,replying:o,messages:c,setReplying:m,typing:N,setTyping:H}=t.useContext(R),e=t.useRef(null),x=t.useRef(null),[I,u]=t.useState(!1),[n,d]=t.useState("");t.useEffect(()=>{o&&e.current.focus()},[o]);const C=()=>{console.log("Typing message sent!"),l.current.send(JSON.stringify({type:"typing"}))},v=t.useRef(O(C,800)),g=()=>{v.current(),u(!0),e.current.style.height="auto",e.current.scrollHeight>e.current.clientHeight&&(e.current.style.height=e.current.scrollHeight+"px"),d(e.current.value)},S=()=>{u(!1),e.current.style.height="unset",e.current.scrollTop=e.current.scrollHeight},j=()=>{if(n==null||n.trim().length===0)return;const p={type:"text",content:n.trimEnd()},h={sentId:i.current,type:"text",origin:"sent",status:"sending",reaction:-1,content:n.trimEnd(),deleted:0};o&&(p.reply={sentId:c[r].receivedId,receivedId:c[r].sentId},h.reply={sentId:c[r].sentId,receivedId:c[r].receivedId},m(!1)),l.current.send(JSON.stringify(p)),y(M=>[...M,h]),i.current=i.current+1,e.current.value="",setTimeout(()=>{f.current.scrollIntoView({behavior:"smooth"})},100),d(null)};return s.jsxs("div",{className:a.inputSpaceContainer,ref:x,children:[!I&&s.jsx("div",{className:a.inputOptions,children:s.jsxs("div",{style:{display:"flex",gap:"1.5rem"},children:[s.jsx("img",{src:"./photos.svg",width:20,height:20}),s.jsx("img",{src:"./microphone.svg",width:20,height:20})]})}),s.jsx("textarea",{onChange:g,onFocus:g,onBlur:S,ref:e,placeholder:"Message",rows:1,spellCheck:!1}),s.jsx("img",{src:"./send.svg",width:24,height:24,className:a.sendImage,style:{opacity:n&&n.trim().length!=0?1:.6},onClick:j})]})}export{B as default};
