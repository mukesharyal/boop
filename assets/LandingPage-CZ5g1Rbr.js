import{j as e,u as f,a as C,w as b,r as m,C as y,s as v}from"./index-CCZYyvQ1.js";const _="_navContainer_lv8av_1",k="_logo_lv8av_9",w="_navList_lv8av_14",N="_hamburger_lv8av_29",t={navContainer:_,logo:k,navList:w,hamburger:N};function L(){return e.jsxs("nav",{"aria-label":"Main Navigation",className:t.navContainer,children:[e.jsx("a",{href:"/",className:t.logo,"aria-label":"Homepage",children:"boop"}),e.jsx("a",{className:t.hamburger,"aria-label":"Expand for menu",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),e.jsxs("ul",{className:t.navList,children:[e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#about",className:t.navLink,children:"About"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#projects",className:t.navLink,children:"Policy"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#contact",className:t.navLink,children:"Contact"})})]})]})}const D="_mainContainer_c2hxc_1",S="_inputCard_c2hxc_17",R="_linkInput_c2hxc_49",I="_loaderWrapper_c2hxc_81",T="_loader_c2hxc_81",u={mainContainer:D,inputCard:S,linkInput:R,loaderWrapper:I,loader:T};async function W(n,o,c,a){console.log("Starting the createLink function! At the beginning of the function, the state = ",n.iceGatheringState);let h=await C({senderName:c,senderDescription:{type:n.localDescription.type,sdp:n.localDescription.sdp},senderCandidates:o.current,receiverName:"",receiverDescription:"",receiverCandidates:""});return console.log("The session has been added to Firebase by the sender! Now, waiting for the receiver!"),b(h,async s=>{await n.setRemoteDescription(new RTCSessionDescription(s.receiverDescription));for(const r of s.receiverCandidates)await n.addIceCandidate(new RTCIceCandidate(r))},a),h}async function F(n,o,c,a){return console.log("When joining the link, the state = ",n.iceGatheringState),await f(a,{receiverName:c,receiverDescription:{type:n.localDescription.type,sdp:n.localDescription.sdp},receiverCandidates:o.current}),"success"}const E=new URLSearchParams(window.location.search),i=E.get("link");function A(n){n.preventDefault(),navigator.clipboard.writeText(n.target.elements.link.value)}const G=({setConnected:n})=>{const[o,c]=m.useState(!1),a=m.useRef(null),h=async g=>{const l=new AudioContext;if(l.createBuffer(1,l.sampleRate*10,l.sampleRate),l.onstatechange=()=>{console.log("AudioContext state:",l.state)},g.preventDefault(),c(!0),i){let d=await F(s,r,a.current.value,i);console.log(d),d?d=="success"&&(s.ondatachannel=j=>{p.current=j.channel,console.log("The data channel has been established!"),n(!0)}):alert("The link you gave doesn't exist.")}else{let d=await W(s,r,a.current.value,x);a.current.value=`https://www.mukesharyal.com.np/boop?link=${d}`,a.current.disabled=!0,navigator.clipboard.writeText(a.current.value)}},{peerConnection:s,iceCandidates:r,dataChannel:p,peerName:x}=m.useContext(y);return m.useEffect(()=>{i?v("receiver",s,p,r,n,x,i):v("sender",s,p,r,n,x,i)},[]),e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsx("main",{className:u.mainContainer,children:e.jsx("section",{className:u.inputCard,children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:u.loaderWrapper,children:e.jsx("div",{className:u.loader})}),e.jsx("h1",{children:i?"Joining the chat":"Waiting for other person to join"}),!i&&e.jsxs("form",{onSubmit:A,children:[e.jsx("input",{autoFocus:!0,name:"link",ref:a,title:"Copy this link",className:u.linkInput}),e.jsx("br",{}),e.jsx("button",{name:"copyLinkButton",children:"Copy Link"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Welcome to Boop.",e.jsx("br",{}),"Let's Get Started!"]}),e.jsxs("form",{onSubmit:h,children:[e.jsx("input",{name:"name",required:!0,minLength:2,maxLength:20,autoComplete:"off",type:"text",placeholder:"Your Name",title:"Enter your name",id:"name",ref:a}),e.jsx("br",{}),i?e.jsx("button",{type:"submit",children:"Join Chat"}):e.jsx("button",{type:"submit",children:"Create Link"})]})]})})})]})};export{G as default};
