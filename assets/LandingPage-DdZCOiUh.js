import{j as e,u as b,a as y,w as _,b as k,r as x,C as w,s as j}from"./index-Dix0VLSN.js";const N="_navContainer_1gt4t_1",L="_logo_1gt4t_9",D="_navList_1gt4t_14",S="_hamburger_1gt4t_29",a={navContainer:N,logo:L,navList:D,hamburger:S};function R(){return e.jsxs("nav",{"aria-label":"Main Navigation",className:a.navContainer,children:[e.jsx("a",{href:"/",className:a.logo,"aria-label":"Homepage",children:"boop"}),e.jsx("a",{className:a.hamburger,"aria-label":"Expand for menu",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),e.jsxs("ul",{className:a.navList,children:[e.jsx("li",{className:a.navItem,children:e.jsx("a",{href:"#about",className:a.navLink,children:"About"})}),e.jsx("li",{className:a.navItem,children:e.jsx("a",{href:"#projects",className:a.navLink,children:"Policy"})}),e.jsx("li",{className:a.navItem,children:e.jsx("a",{href:"#contact",className:a.navLink,children:"Contact"})})]})]})}const T="_mainContainer_c2hxc_1",I="_inputCard_c2hxc_17",W="_linkInput_c2hxc_49",F="_loaderWrapper_c2hxc_81",A="_loader_c2hxc_81",d={mainContainer:T,inputCard:I,linkInput:W,loaderWrapper:F,loader:A};async function E(n,i,o,t){console.log("Starting the createLink function! At the beginning of the function, the state = ",n.iceGatheringState);let u=await y({senderName:o,senderDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},senderCandidates:i.current,receiverName:"",receiverDescription:"",receiverCandidates:""});return console.log("The session has been added to Firebase by the sender! Now, waiting for the receiver!"),_(u,async h=>{await n.current.setRemoteDescription(new RTCSessionDescription(h.receiverDescription));for(const r of h.receiverCandidates)await n.current.addIceCandidate(new RTCIceCandidate(r))},t),u}async function B(n,i,o,t){return console.log("After the waiting, the state = ",n.current.iceGatheringState),await b(t,{receiverName:o,receiverDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},receiverCandidates:i.current}),"success"}const G=new URLSearchParams(window.location.search),s=G.get("link"),H=()=>{const{showNotification:n}=k(),[i,o]=x.useState(!1),t=x.useRef(null);function u(m){m.preventDefault(),navigator.clipboard.writeText(m.target.elements.link.value),n("The link has been copied!")}const h=async m=>{const c=new AudioContext;if(c.createBuffer(1,c.sampleRate*10,c.sampleRate),c.onstatechange=()=>{console.log("AudioContext state:",c.state)},m.preventDefault(),o(!0),s){let l=await B(r,p,t.current.value,s);console.log(l),l?l=="success"&&(r.current.ondatachannel=C=>{g.current=C.channel,console.log("The data channel has been established!"),f(!0)}):alert("The link you gave doesn't exist.")}else{let l=await E(r,p,t.current.value,v);t.current.value=`https://localhost:5173/?link=${l}`,t.current.disabled=!0,navigator.clipboard.writeText(t.current.value),n("The link has been copied!")}},{peerConnection:r,iceCandidates:p,dataChannel:g,peerName:v,setConnected:f}=x.useContext(w);return x.useEffect(()=>{s?j("receiver",r,g,p,f,v,s):j("sender",r,g,p,f,v,s)},[]),e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("main",{className:d.mainContainer,children:e.jsx("section",{className:d.inputCard,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:d.loaderWrapper,children:e.jsx("div",{className:d.loader})}),e.jsx("h1",{children:s?"Joining the chat":"Waiting for other person to join"}),!s&&e.jsxs("form",{onSubmit:u,children:[e.jsx("input",{autoFocus:!0,name:"link",ref:t,title:"Copy this link",className:d.linkInput}),e.jsx("br",{}),e.jsx("button",{name:"copyLinkButton",children:"Copy Link"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Welcome to Boop.",e.jsx("br",{}),"Let's Get Started!"]}),e.jsxs("form",{onSubmit:h,children:[e.jsx("input",{name:"name",required:!0,minLength:2,maxLength:20,autoComplete:"off",type:"text",placeholder:"Your Name",title:"Enter your name",id:"name",ref:t}),e.jsx("br",{}),s?e.jsx("button",{type:"submit",children:"Join Chat"}):e.jsx("button",{type:"submit",children:"Create Link"})]})]})})})]})};export{H as default};
