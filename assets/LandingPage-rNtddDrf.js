import{j as e,u as k,a as y,w,r as g,C as _,b as N,s as f}from"./index-CngHVNkC.js";const L="_navContainer_2izlb_1",D="_logo_2izlb_10",S="_navList_2izlb_15",T="_hamburger_2izlb_30",t={navContainer:L,logo:D,navList:S,hamburger:T};function R(){return e.jsxs("nav",{"aria-label":"Main Navigation",className:t.navContainer,children:[e.jsx("a",{href:"/",className:t.logo,"aria-label":"Homepage",children:"boop"}),e.jsx("a",{className:t.hamburger,"aria-label":"Expand for menu",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),e.jsxs("ul",{className:t.navList,children:[e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#about",className:t.navLink,children:"About"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#projects",className:t.navLink,children:"Policy"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#contact",className:t.navLink,children:"Contact"})})]})]})}const I="_mainContainer_15mr1_1",W="_inputCard_15mr1_13",F="_linkInput_15mr1_41",A="_loaderWrapper_15mr1_71",E="_loader_15mr1_71",h={mainContainer:I,inputCard:W,linkInput:F,loaderWrapper:A,loader:E};async function z(n,a,r,i){console.log("Starting the createLink function! At the beginning of the function, the state = ",n.iceGatheringState),console.log("The iceCandidate object looks like this: ",a.current);let c=await y({senderName:r,senderDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},senderCandidates:a.current,receiverName:"",receiverDescription:"",receiverCandidates:""});return console.log("The session has been added to Firebase by the sender! Now, waiting for the receiver!"),w(c,async l=>{await n.current.setRemoteDescription(new RTCSessionDescription(l.receiverDescription));for(const m of l.receiverCandidates)await n.current.addIceCandidate(new RTCIceCandidate(m))},i),c}async function B(n,a,r,i){return console.log("After the waiting, the state = ",n.current.iceGatheringState),await k(i,{receiverName:r,receiverDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},receiverCandidates:a.current}),"success"}const G=new URLSearchParams(window.location.search),s=G.get("link"),H=()=>{const{peerConnection:n,iceCandidates:a,dataChannel:r,imageChannel:i,peerName:c,setConnected:l}=g.useContext(_),{showNotification:m}=N(),[b,j]=g.useState(!1),o=g.useRef(null);function C(p){p.preventDefault(),navigator.clipboard.writeText(p.target.elements.link.value),m("The link has been copied!")}const v=async p=>{const u=new AudioContext;if(u.createBuffer(1,u.sampleRate*10,u.sampleRate),u.onstatechange=()=>{console.log("AudioContext state:",u.state)},p.preventDefault(),j(!0),s){let d=await B(n,a,o.current.value,s);console.log(d),d?d=="success"&&(n.current.ondatachannel=x=>{x.channel.label==="chat"&&(r.current=x.channel,console.log("The data channel has been established!"),l(!0)),x.channel.label==="image"&&(i.current=x.channel,console.log("The image channel has been established!"))}):alert("The link you gave doesn't exist.")}else{let d=await z(n,a,o.current.value,c);o.current.value=`https://www.mukesharyal.com.np/boop?link=${d}`,o.current.disabled=!0,navigator.clipboard.writeText(o.current.value),m("The link has been copied!")}};return g.useEffect(()=>{s?f("receiver",n,r,i,a,l,c,s):f("sender",n,r,i,a,l,c,s)},[]),e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("main",{className:h.mainContainer,children:e.jsx("section",{className:h.inputCard,children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:h.loaderWrapper,children:e.jsx("div",{className:h.loader})}),e.jsx("h1",{children:s?"Joining the chat":"Waiting for other person to join"}),!s&&e.jsxs("form",{onSubmit:C,children:[e.jsx("input",{autoFocus:!0,spellCheck:!1,autoComplete:"off",name:"link",ref:o,title:"Copy this link",className:h.linkInput}),e.jsx("br",{}),e.jsx("button",{name:"copyLinkButton",children:"Copy Link"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Welcome to Boop.",e.jsx("br",{}),"Let's Get Started!"]}),e.jsxs("form",{onSubmit:v,children:[e.jsx("input",{name:"name",required:!0,minLength:2,maxLength:20,autoComplete:"off",type:"text",spellCheck:!1,placeholder:"Your Name",title:"Enter your name",id:"name",ref:o}),e.jsx("br",{}),s?e.jsx("button",{type:"submit",children:"Join Chat"}):e.jsx("button",{type:"submit",children:"Create Link"})]})]})})})]})};export{H as default};
