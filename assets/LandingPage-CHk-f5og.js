import{j as e,u as y,a as k,w,r as g,C as _,b as N,s as f}from"./index-Cr1LMo6m.js";const L="_navContainer_rzp5o_1",D="_logo_rzp5o_10",S="_navList_rzp5o_15",T="_hamburger_rzp5o_30",t={navContainer:L,logo:D,navList:S,hamburger:T};function R(){return e.jsxs("nav",{"aria-label":"Main Navigation",className:t.navContainer,children:[e.jsx("a",{href:"/",className:t.logo,"aria-label":"Homepage",children:"boop"}),e.jsx("a",{className:t.hamburger,"aria-label":"Expand for menu",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:[e.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),e.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),e.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}),e.jsxs("ul",{className:t.navList,children:[e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#about",className:t.navLink,children:"About"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#projects",className:t.navLink,children:"Policy"})}),e.jsx("li",{className:t.navItem,children:e.jsx("a",{href:"#contact",className:t.navLink,children:"Contact"})})]})]})}const I="_mainContainer_oi6yl_1",W="_inputCard_oi6yl_13",F="_linkInput_oi6yl_44",A="_loaderWrapper_oi6yl_76",E="_loader_oi6yl_76",h={mainContainer:I,inputCard:W,linkInput:F,loaderWrapper:A,loader:E};async function z(n,a,i,r){console.log("Starting the createLink function! At the beginning of the function, the state = ",n.iceGatheringState),console.log("The iceCandidate object looks like this: ",a.current);let c=await k({senderName:i,senderDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},senderCandidates:a.current,receiverName:"",receiverDescription:"",receiverCandidates:""});return console.log("The session has been added to Firebase by the sender! Now, waiting for the receiver!"),w(c,async l=>{await n.current.setRemoteDescription(new RTCSessionDescription(l.receiverDescription));for(const p of l.receiverCandidates)await n.current.addIceCandidate(new RTCIceCandidate(p))},r),c}async function B(n,a,i,r){return console.log("After the waiting, the state = ",n.current.iceGatheringState),await y(r,{receiverName:i,receiverDescription:{type:n.current.localDescription.type,sdp:n.current.localDescription.sdp},receiverCandidates:a.current}),"success"}const G=new URLSearchParams(window.location.search),s=G.get("link"),H=()=>{const{peerConnection:n,iceCandidates:a,dataChannel:i,imageChannel:r,peerName:c,setConnected:l}=g.useContext(_),{showNotification:p}=N(),[j,b]=g.useState(!1),o=g.useRef(null);function v(m){m.preventDefault(),navigator.clipboard.writeText(m.target.elements.link.value),p("The link has been copied!")}const C=async m=>{const d=new AudioContext;if(d.createBuffer(1,d.sampleRate*10,d.sampleRate),d.onstatechange=()=>{console.log("AudioContext state:",d.state)},m.preventDefault(),b(!0),s){let u=await B(n,a,o.current.value,s);console.log(u),u?u=="success"&&(n.current.ondatachannel=x=>{x.channel.label==="chat"&&(i.current=x.channel,console.log("The data channel has been established!"),l(!0)),x.channel.label==="image"&&(r.current=x.channel,console.log("The image channel has been established!"))}):alert("The link you gave doesn't exist.")}else{let u=await z(n,a,o.current.value,c);o.current.value=`https://www.mukesharyal.com.np/boop?link=${u}`,o.current.disabled=!0,navigator.clipboard.writeText(o.current.value),p("The link has been copied!")}};return g.useEffect(()=>{s?f("receiver",n,i,r,a,l,c,s):f("sender",n,i,r,a,l,c,s)},[]),e.jsxs(e.Fragment,{children:[e.jsx(R,{}),e.jsx("main",{className:h.mainContainer,children:e.jsx("section",{className:h.inputCard,children:j?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:h.loaderWrapper,children:e.jsx("div",{className:h.loader})}),e.jsx("h1",{children:s?"Joining the chat":"Waiting for other person to join"}),!s&&e.jsxs("form",{onSubmit:v,children:[e.jsx("input",{autoFocus:!0,name:"link",ref:o,title:"Copy this link",className:h.linkInput}),e.jsx("br",{}),e.jsx("button",{name:"copyLinkButton",children:"Copy Link"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("h1",{children:["Welcome to Boop.",e.jsx("br",{}),"Let's Get Started!"]}),e.jsxs("form",{onSubmit:C,children:[e.jsx("input",{name:"name",required:!0,minLength:2,maxLength:20,autoComplete:"off",type:"text",placeholder:"Your Name",title:"Enter your name",id:"name",ref:o}),e.jsx("br",{}),s?e.jsx("button",{type:"submit",children:"Join Chat"}):e.jsx("button",{type:"submit",children:"Create Link"})]})]})})})]})};export{H as default};
